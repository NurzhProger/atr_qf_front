import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output, ViewChild, } from '@angular/core';
import { BehaviorSubject, Subject, takeUntil } from 'rxjs';
import { take } from 'rxjs/operators';
import { EventManager } from '../../event-manager/event-manager';
import { generateRandomId } from '../../utils/generate-random-id';
import * as i0 from "@angular/core";
import * as i1 from "../../services/ya-api-loader/ya-api-loader.service";
/**
 * The `ya-map` component wraps `ymaps.Map` class from the Yandex.Maps API.
 * You can configure the map via the component's inputs.
 * Events can be bound using the outputs of the component.
 *
 * <example-url>https://stackblitz.com/edit/map-onload-event?embed=1&view=preview</example-url>
 *
 * @example
 * ```html
 * <ya-map
 *   [center]="[55.751952, 37.600739]"
 *   [state]="{type: 'yandex#satellite'}"
 * ></ya-map>
 * ```
 */
export class YaMapComponent {
    constructor(ngZone, yaApiLoaderService) {
        this.ngZone = ngZone;
        this.yaApiLoaderService = yaApiLoaderService;
        this.destroy$ = new Subject();
        this.eventManager = new EventManager(this.ngZone);
        this.map$ = new BehaviorSubject(null);
        /**
         * Map instance is created.
         */
        this.ready = new EventEmitter();
        /**
         * The start of a new smooth map movement.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-actionbegin}
         */
        this.actionbegin = this.eventManager.getLazyEmitter('actionbegin');
        /**
         * Event that occurs when an action step was prematurely stopped.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-actionbreak}
         */
        this.actionbreak = this.eventManager.getLazyEmitter('actionbreak');
        /**
         * The end of smooth map movement.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-actionend}
         */
        this.actionend = this.eventManager.getLazyEmitter('actionend');
        /**
         * The start of a new step of smooth movement.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-actiontick}
         */
        this.actiontick = this.eventManager.getLazyEmitter('actiontick');
        /**
         * The end of performing a step of smooth movement.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-actiontickcomplete}
         */
        this.actiontickcomplete = this.eventManager.getLazyEmitter('actiontickcomplete');
        /**
         * Closing the balloon.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-balloonclose}
         */
        this.balloonclose = this.eventManager.getLazyEmitter('balloonclose');
        /**
         * Opening a balloon on a map.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-balloonopen}
         */
        this.balloonopen = this.eventManager.getLazyEmitter('balloonopen');
        /**
         * Event for a change to the map viewport.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-boundschange}
         */
        this.boundschange = this.eventManager.getLazyEmitter('boundschange');
        /**
         * Single left-click on the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-click}
         */
        this.yaclick = this.eventManager.getLazyEmitter('click');
        /**
         * Calls the element's context menu.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-contextmenu}
         */
        this.yacontextmenu = this.eventManager.getLazyEmitter('contextmenu');
        /**
         * Double left-click on the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-dblclick}
         */
        this.yadblclick = this.eventManager.getLazyEmitter('dblclick');
        /**
         * The map was destroyed.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-destroy}
         */
        this.destroy = this.eventManager.getLazyEmitter('destroy');
        /**
         * Closing the hint.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-hintclose}
         */
        this.hintclose = this.eventManager.getLazyEmitter('hintclose');
        /**
         * Opening a hint on a map.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-hintopen}
         */
        this.hintopen = this.eventManager.getLazyEmitter('hintopen');
        /**
         * Map margins changed.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-marginchange}
         */
        this.marginchange = this.eventManager.getLazyEmitter('marginchange');
        /**
         * Pressing the mouse button over the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mousedown}
         */
        this.yamousedown = this.eventManager.getLazyEmitter('mousedown');
        /**
         * Pointing the cursor at the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mouseenter}
         */
        this.yamouseenter = this.eventManager.getLazyEmitter('mouseenter');
        /**
         * Moving the cursor off of the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mouseleave}
         */
        this.yamouseleave = this.eventManager.getLazyEmitter('mouseleave');
        /**
         * Moving the cursor over the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mousemove}
         */
        this.yamousemove = this.eventManager.getLazyEmitter('mousemove');
        /**
         * Letting go of the mouse button over an object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mouseup}
         */
        this.yamouseup = this.eventManager.getLazyEmitter('mouseup');
        /**
         * End of multitouch.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-multitouchend}
         */
        this.multitouchend = this.eventManager.getLazyEmitter('multitouchend');
        /**
         * Repeating event during multitouch.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-multitouchmove}
         */
        this.multitouchmove = this.eventManager.getLazyEmitter('multitouchmove');
        /**
         * Start of multitouch.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-multitouchstart}
         */
        this.multitouchstart = this.eventManager.getLazyEmitter('multitouchstart');
        /**
         * Map options changed.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-optionschange}
         */
        this.optionschange = this.eventManager.getLazyEmitter('optionschange');
        /**
         * Map size changed.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-sizechange}
         */
        this.sizechange = this.eventManager.getLazyEmitter('sizechange');
        /**
         * The map type changed.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/Map.html#event_detail__event-typechange}
         */
        this.typechange = this.eventManager.getLazyEmitter('typechange');
        /**
         * Mouse wheel scrolling.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-wheel}
         */
        this.yawheel = this.eventManager.getLazyEmitter('wheel');
    }
    /**
     * Handles input changes and passes them in API.
     * @param changes
     */
    ngOnChanges(changes) {
        const map = this.map$.value;
        if (map) {
            const { center, zoom, state, options } = changes;
            if (state) {
                this.setState(this.combineState(), map);
            }
            if (center) {
                map.setCenter(center.currentValue);
            }
            if (zoom) {
                map.setZoom(zoom.currentValue);
            }
            if (options) {
                map.options.set(options.currentValue);
            }
        }
    }
    ngAfterViewInit() {
        this.yaApiLoaderService
            .load()
            .pipe(take(1), takeUntil(this.destroy$))
            .subscribe(() => {
            const id = generateRandomId();
            const map = this.createMap(id);
            this.map$.next(map);
            this.eventManager.setTarget(map);
            this.ngZone.run(() => this.ready.emit({ ymaps, target: map }));
        });
    }
    ngOnDestroy() {
        this.eventManager.destroy();
        this.destroy$.next();
        this.destroy$.complete();
    }
    /**
     * Destructs state and passes it in API.
     * @param state
     * @param map
     */
    setState(state, map) {
        const { behaviors, bounds, center, controls, margin, type, zoom } = state;
        if (behaviors) {
            map.behaviors.enable(behaviors);
        }
        if (bounds) {
            map.setBounds(bounds);
        }
        if (center) {
            map.setCenter(center);
        }
        if (controls) {
            controls.forEach((control) => map.controls.add(control));
        }
        if (margin) {
            map.margin.setDefaultMargin(margin);
        }
        if (type) {
            map.setType(type);
        }
        if (zoom) {
            map.setZoom(zoom);
        }
    }
    /**
     * Creates a map.
     * @param id ID which will be set to the map container.
     */
    createMap(id) {
        const containerElem = this.container.nativeElement;
        containerElem.setAttribute('id', id);
        containerElem.style.cssText = 'width: 100%; height: 100%;';
        return new ymaps.Map(id, this.combineState(), this.options || {});
    }
    /**
     * Combines the center and zoom into single object.
     */
    combineState() {
        const state = this.state || {};
        return {
            ...state,
            center: this.center || state.center || [0, 0],
            zoom: this.zoom ?? state.zoom ?? 10,
        };
    }
}
YaMapComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.5", ngImport: i0, type: YaMapComponent, deps: [{ token: i0.NgZone }, { token: i1.YaApiLoaderService }], target: i0.ɵɵFactoryTarget.Component });
YaMapComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.2.5", type: YaMapComponent, selector: "ya-map", inputs: { center: "center", zoom: "zoom", state: "state", options: "options" }, outputs: { ready: "ready", actionbegin: "actionbegin", actionbreak: "actionbreak", actionend: "actionend", actiontick: "actiontick", actiontickcomplete: "actiontickcomplete", balloonclose: "balloonclose", balloonopen: "balloonopen", boundschange: "boundschange", yaclick: "yaclick", yacontextmenu: "yacontextmenu", yadblclick: "yadblclick", destroy: "destroy", hintclose: "hintclose", hintopen: "hintopen", marginchange: "marginchange", yamousedown: "yamousedown", yamouseenter: "yamouseenter", yamouseleave: "yamouseleave", yamousemove: "yamousemove", yamouseup: "yamouseup", multitouchend: "multitouchend", multitouchmove: "multitouchmove", multitouchstart: "multitouchstart", optionschange: "optionschange", sizechange: "sizechange", typechange: "typechange", yawheel: "yawheel" }, viewQueries: [{ propertyName: "container", first: true, predicate: ["container"], descendants: true }], usesOnChanges: true, ngImport: i0, template: '<div #container></div>', isInline: true, changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.5", ngImport: i0, type: YaMapComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'ya-map',
                    template: '<div #container></div>',
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.NgZone }, { type: i1.YaApiLoaderService }]; }, propDecorators: { container: [{
                type: ViewChild,
                args: ['container']
            }], center: [{
                type: Input
            }], zoom: [{
                type: Input
            }], state: [{
                type: Input
            }], options: [{
                type: Input
            }], ready: [{
                type: Output
            }], actionbegin: [{
                type: Output
            }], actionbreak: [{
                type: Output
            }], actionend: [{
                type: Output
            }], actiontick: [{
                type: Output
            }], actiontickcomplete: [{
                type: Output
            }], balloonclose: [{
                type: Output
            }], balloonopen: [{
                type: Output
            }], boundschange: [{
                type: Output
            }], yaclick: [{
                type: Output
            }], yacontextmenu: [{
                type: Output
            }], yadblclick: [{
                type: Output
            }], destroy: [{
                type: Output
            }], hintclose: [{
                type: Output
            }], hintopen: [{
                type: Output
            }], marginchange: [{
                type: Output
            }], yamousedown: [{
                type: Output
            }], yamouseenter: [{
                type: Output
            }], yamouseleave: [{
                type: Output
            }], yamousemove: [{
                type: Output
            }], yamouseup: [{
                type: Output
            }], multitouchend: [{
                type: Output
            }], multitouchmove: [{
                type: Output
            }], multitouchstart: [{
                type: Output
            }], optionschange: [{
                type: Output
            }], sizechange: [{
                type: Output
            }], typechange: [{
                type: Output
            }], yawheel: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieWEtbWFwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2FuZ3VsYXI4LXlhbmRleC1tYXBzL3NyYy9saWIvY29tcG9uZW50cy95YS1tYXAveWEtbWFwLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBRUwsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFFVCxZQUFZLEVBQ1osS0FBSyxFQUlMLE1BQU0sRUFFTixTQUFTLEdBQ1YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGVBQWUsRUFBYyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3ZFLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV0QyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFJakUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7OztBQUVsRTs7Ozs7Ozs7Ozs7Ozs7R0FjRztBQU1ILE1BQU0sT0FBTyxjQUFjO0lBa096QixZQUNtQixNQUFjLEVBQ2Qsa0JBQXNDO1FBRHRDLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO1FBak94QyxhQUFRLEdBQUcsSUFBSSxPQUFPLEVBQVEsQ0FBQztRQUUvQixpQkFBWSxHQUFHLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUU5RCxTQUFJLEdBQUcsSUFBSSxlQUFlLENBQW1CLElBQUksQ0FBQyxDQUFDO1FBNEJuRDs7V0FFRztRQUNPLFVBQUssR0FBMEMsSUFBSSxZQUFZLEVBRXRFLENBQUM7UUFFSjs7O1dBR0c7UUFDTyxnQkFBVyxHQUNuQixJQUFJLENBQUMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUVsRDs7O1dBR0c7UUFDTyxnQkFBVyxHQUNu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QUFDLE1BQU07aUJBQ2hEOzhIQUVrQyxTQUFTO3NCQUF6QyxTQUFTO3VCQUFDLFdBQVc7Z0JBYWIsTUFBTTtzQkFBZCxLQUFLO2dCQU9HLElBQUk7c0JBQVosS0FBSztnQkFNRyxLQUFLO3NCQUFiLEtBQUs7Z0JBTUcsT0FBTztzQkFBZixLQUFLO2dCQUtJLEtBQUs7c0JBQWQsTUFBTTtnQkFRRyxXQUFXO3NCQUFwQixNQUFNO2dCQU9HLFdBQVc7c0JBQXBCLE1BQU07Z0JBT0csU0FBUztzQkFBbEIsTUFBTTtnQkFPRyxVQUFVO3NCQUFuQixNQUFNO2dCQU9HLGtCQUFrQjtzQkFBM0IsTUFBTTtnQkFPRyxZQUFZO3NCQUFyQixNQUFNO2dCQU9HLFdBQVc7c0JBQXBCLE1BQU07Z0JBT0csWUFBWTtzQkFBckIsTUFBTTtnQkFPRyxPQUFPO3NCQUFoQixNQUFNO2dCQU1HLGFBQWE7c0JBQXRCLE1BQU07Z0JBT0csVUFBVTtzQkFBbkIsTUFBTTtnQkFPRyxPQUFPO3NCQUFoQixNQUFNO2dCQU1HLFNBQVM7c0JBQWxCLE1BQU07Z0JBT0csUUFBUTtzQkFBakIsTUFBTTtnQkFNRyxZQUFZO3NCQUFyQixNQUFNO2dCQU9HLFdBQVc7c0JBQXBCLE1BQU07Z0JBT0csWUFBWTtzQkFBckIsTUFBTTtnQkFPRyxZQUFZO3NCQUFyQixNQUFNO2dCQU9HLFdBQVc7c0JBQXBCLE1BQU07Z0JBT0csU0FBUztzQkFBbEIsTUFBTTtnQkFNRyxhQUFhO3NCQUF0QixNQUFNO2dCQU9HLGNBQWM7c0JBQXZCLE1BQU07Z0JBT0csZUFBZTtzQkFBeEIsTUFBTTtnQkFPRyxhQUFhO3NCQUF0QixNQUFNO2dCQU9HLFVBQVU7c0JBQW5CLE1BQU07Z0JBT0csVUFBVTtzQkFBbkIsTUFBTTtnQkFPRyxPQUFPO3NCQUFoQixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBBZnRlclZpZXdJbml0LFxyXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxyXG4gIENvbXBvbmVudCxcclxuICBFbGVtZW50UmVmLFxyXG4gIEV2ZW50RW1pdHRlcixcclxuICBJbnB1dCxcclxuICBOZ1pvbmUsXHJcbiAgT25DaGFuZ2VzLFxyXG4gIE9uRGVzdHJveSxcclxuICBPdXRwdXQsXHJcbiAgU2ltcGxlQ2hhbmdlcyxcclxuICBWaWV3Q2hpbGQsXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgT2JzZXJ2YWJsZSwgU3ViamVjdCwgdGFrZVVudGlsIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHRha2UgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcblxyXG5pbXBvcnQgeyBFdmVudE1hbmFnZXIgfSBmcm9tICcuLi8uLi9ldmVudC1tYW5hZ2VyL2V2ZW50LW1hbmFnZXInO1xyXG5pbXBvcnQgeyBZYUV2ZW50IH0gZnJvbSAnLi4vLi4vbW9kZWxzL3lhLWV2ZW50JztcclxuaW1wb3J0IHsgWWFSZWFkeUV2ZW50IH0gZnJvbSAnLi4vLi4vbW9kZWxzL3lhLXJlYWR5LWV2ZW50JztcclxuaW1wb3J0IHsgWWFBcGlMb2FkZXJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMveWEtYXBpLWxvYWRlci95YS1hcGktbG9hZGVyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBnZW5lcmF0ZVJhbmRvbUlkIH0gZnJvbSAnLi4vLi4vdXRpbHMvZ2VuZXJhdGUtcmFuZG9tLWlkJztcclxuXHJcbi8qKlxyXG4gKiBUaGUgYHlhLW1hcGAgY29tcG9uZW50IHdyYXBzIGB5bWFwcy5NYXBgIGNsYXNzIGZyb20gdGhlIFlhbmRleC5NYXBzIEFQSS5cclxuICogWW91IGNhbiBjb25maWd1cmUgdGhlIG1hcCB2aWEgdGhlIGNvbXBvbmVudCdzIGlucHV0cy5cclxuICogRXZlbnRzIGNhbiBiZSBib3VuZCB1c2luZyB0aGUgb3V0cHV0cyBvZiB0aGUgY29tcG9uZW50LlxyXG4gKlxyXG4gKiA8ZXhhbXBsZS11cmw+aHR0cHM6Ly9zdGFja2JsaXR6LmNvbS9lZGl0L21hcC1vbmxvYWQtZXZlbnQ/ZW1iZWQ9MSZ2aWV3PXByZXZpZXc8L2V4YW1wbGUtdXJsPlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBodG1sXHJcbiAqIDx5YS1tYXBcclxuICogICBbY2VudGVyXT1cIls1NS43NTE5NTIsIDM3LjYwMDczOV1cIlxyXG4gKiAgIFtzdGF0ZV09XCJ7dHlwZTogJ3lhbmRleCNzYXRlbGxpdGUnfVwiXHJcbiAqID48L3lhLW1hcD5cclxuICogYGBgXHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3lhLW1hcCcsXHJcbiAgdGVtcGxhdGU6ICc8ZGl2ICNjb250YWluZXI+PC9kaXY+JyxcclxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxufSlcclxuZXhwb3J0IGNsYXNzIFlhTWFwQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xyXG4gIEBWaWV3Q2hpbGQoJ2NvbnRhaW5lcicpIHJlYWRvbmx5IGNvbnRhaW5lcjogRWxlbWVudFJlZjtcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkZXN0cm95JCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZXZlbnRNYW5hZ2VyID0gbmV3IEV2ZW50TWFuYWdlcih0aGlzLm5nWm9uZSk7XHJcblxyXG4gIG1hcCQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PHltYXBzLk1hcCB8IG51bGw+KG51bGwpO1xyXG5cclxuICAvKipcclxuICAgKiBHZW8gY29vcmRpbmF0ZXMgb2YgdGhlIG1hcCBjZW50ZXIuIERlZmF1bHQgaXMgYFswLCAwXWAuXHJcbiAgICogU2hvcnRoYW5kIGZvciBgW3N0YXRlXT1cInsgY2VudGVyOiBbMCwgMF0gfVwiYC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNNYXBfX3BhcmFtLXN0YXRlLmNlbnRlcn1cclxuICAgKi9cclxuICBASW5wdXQoKSBjZW50ZXI6IG51bWJlcltdO1xyXG5cclxuICAvKipcclxuICAgKiBNYXAgem9vbSBsZXZlbC4gRGVmYXVsdCBsZXZlbCBpcyBgMTBgLlxyXG4gICAqIFNob3J0aGFuZCBmb3IgYFtzdGF0ZV09XCJ7IHpvb206IDEwIH1cImAuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvTWFwLmh0bWwjTWFwX19wYXJhbS1zdGF0ZS56b29tfVxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIHpvb206IG51bWJlcjtcclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIHBhcmFtZXRlcnMuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvTWFwLmh0bWwjTWFwX19wYXJhbS1zdGF0ZX1cclxuICAgKi9cclxuICBASW5wdXQoKSBzdGF0ZTogeW1hcHMuSU1hcFN0YXRlO1xyXG5cclxuICAvKipcclxuICAgKiBNYXAgb3B0aW9ucy4gVGhlIG1hcCBvcHRpb25zIGNhbiBiZSB1c2VkIHRvIG1ha2Ugc2V0dGluZ3MgZm9yIHRoZSBtYXAgaXRzZWxmLCBhcyB3ZWxsIGFzIGZvciBvYmplY3RzIHRoYXQgYXJlIGFkZGVkIHRvIGl0LlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL01hcC5odG1sI01hcF9fcGFyYW0tb3B0aW9uc31cclxuICAgKi9cclxuICBASW5wdXQoKSBvcHRpb25zOiB5bWFwcy5JTWFwT3B0aW9ucztcclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIGluc3RhbmNlIGlzIGNyZWF0ZWQuXHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHJlYWR5OiBFdmVudEVtaXR0ZXI8WWFSZWFkeUV2ZW50PHltYXBzLk1hcD4+ID0gbmV3IEV2ZW50RW1pdHRlcjxcclxuICAgIFlhUmVhZHlFdmVudDx5bWFwcy5NYXA+XHJcbiAgPigpO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgc3RhcnQgb2YgYSBuZXcgc21vb3RoIG1hcCBtb3ZlbWVudC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LWFjdGlvbmJlZ2lufVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBhY3Rpb25iZWdpbjogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLk1hcD4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdhY3Rpb25iZWdpbicpO1xyXG5cclxuICAvKipcclxuICAgKiBFdmVudCB0aGF0IG9jY3VycyB3aGVuIGFuIGFjdGlvbiBzdGVwIHdhcyBwcmVtYXR1cmVseSBzdG9wcGVkLlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL01hcC5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtYWN0aW9uYnJlYWt9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIGFjdGlvbmJyZWFrOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2FjdGlvbmJyZWFrJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoZSBlbmQgb2Ygc21vb3RoIG1hcCBtb3ZlbWVudC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LWFjdGlvbmVuZH1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgYWN0aW9uZW5kOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2FjdGlvbmVuZCcpO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgc3RhcnQgb2YgYSBuZXcgc3RlcCBvZiBzbW9vdGggbW92ZW1lbnQuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvTWFwLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1hY3Rpb250aWNrfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBhY3Rpb250aWNrOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2FjdGlvbnRpY2snKTtcclxuXHJcbiAgLyoqXHJcbiAgICogVGhlIGVuZCBvZiBwZXJmb3JtaW5nIGEgc3RlcCBvZiBzbW9vdGggbW92ZW1lbnQuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvTWFwLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1hY3Rpb250aWNrY29tcGxldGV9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIGFjdGlvbnRpY2tjb21wbGV0ZTogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLk1hcD4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdhY3Rpb250aWNrY29tcGxldGUnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2xvc2luZyB0aGUgYmFsbG9vbi5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LWJhbGxvb25jbG9zZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgYmFsbG9vbmNsb3NlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2JhbGxvb25jbG9zZScpO1xyXG5cclxuICAvKipcclxuICAgKiBPcGVuaW5nIGEgYmFsbG9vbiBvbiBhIG1hcC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LWJhbGxvb25vcGVufVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBiYWxsb29ub3BlbjogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLk1hcD4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdiYWxsb29ub3BlbicpO1xyXG5cclxuICAvKipcclxuICAgKiBFdmVudCBmb3IgYSBjaGFuZ2UgdG8gdGhlIG1hcCB2aWV3cG9ydC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LWJvdW5kc2NoYW5nZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgYm91bmRzY2hhbmdlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2JvdW5kc2NoYW5nZScpO1xyXG5cclxuICAvKipcclxuICAgKiBTaW5nbGUgbGVmdC1jbGljayBvbiB0aGUgb2JqZWN0LlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL0lEb21FdmVudEVtaXR0ZXIuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LWNsaWNrfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSB5YWNsaWNrOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPSB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignY2xpY2snKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbHMgdGhlIGVsZW1lbnQncyBjb250ZXh0IG1lbnUuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtY29udGV4dG1lbnV9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHlhY29udGV4dG1lbnU6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignY29udGV4dG1lbnUnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogRG91YmxlIGxlZnQtY2xpY2sgb24gdGhlIG9iamVjdC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JRG9tRXZlbnRFbWl0dGVyLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1kYmxjbGlja31cclxuICAgKi9cclxuICBAT3V0cHV0KCkgeWFkYmxjbGljazogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLk1hcD4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdkYmxjbGljaycpO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgbWFwIHdhcyBkZXN0cm95ZWQuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvTWFwLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1kZXN0cm95fVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBkZXN0cm95OiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPSB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignZGVzdHJveScpO1xyXG5cclxuICAvKipcclxuICAgKiBDbG9zaW5nIHRoZSBoaW50LlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL01hcC5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtaGludGNsb3NlfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBoaW50Y2xvc2U6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignaGludGNsb3NlJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIE9wZW5pbmcgYSBoaW50IG9uIGEgbWFwLlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL01hcC5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtaGludG9wZW59XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIGhpbnRvcGVuOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPSB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignaGludG9wZW4nKTtcclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIG1hcmdpbnMgY2hhbmdlZC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LW1hcmdpbmNoYW5nZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgbWFyZ2luY2hhbmdlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ21hcmdpbmNoYW5nZScpO1xyXG5cclxuICAvKipcclxuICAgKiBQcmVzc2luZyB0aGUgbW91c2UgYnV0dG9uIG92ZXIgdGhlIG9iamVjdC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JRG9tRXZlbnRFbWl0dGVyLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1tb3VzZWRvd259XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHlhbW91c2Vkb3duOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ21vdXNlZG93bicpO1xyXG5cclxuICAvKipcclxuICAgKiBQb2ludGluZyB0aGUgY3Vyc29yIGF0IHRoZSBvYmplY3QuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtbW91c2VlbnRlcn1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgeWFtb3VzZWVudGVyOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ21vdXNlZW50ZXInKTtcclxuXHJcbiAgLyoqXHJcbiAgICogTW92aW5nIHRoZSBjdXJzb3Igb2ZmIG9mIHRoZSBvYmplY3QuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtbW91c2VsZWF2ZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgeWFtb3VzZWxlYXZlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ21vdXNlbGVhdmUnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogTW92aW5nIHRoZSBjdXJzb3Igb3ZlciB0aGUgb2JqZWN0LlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL0lEb21FdmVudEVtaXR0ZXIuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LW1vdXNlbW92ZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgeWFtb3VzZW1vdmU6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignbW91c2Vtb3ZlJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIExldHRpbmcgZ28gb2YgdGhlIG1vdXNlIGJ1dHRvbiBvdmVyIGFuIG9iamVjdC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JRG9tRXZlbnRFbWl0dGVyLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1tb3VzZXVwfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSB5YW1vdXNldXA6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9IHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdtb3VzZXVwJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEVuZCBvZiBtdWx0aXRvdWNoLlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL0lEb21FdmVudEVtaXR0ZXIuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LW11bHRpdG91Y2hlbmR9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIG11bHRpdG91Y2hlbmQ6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignbXVsdGl0b3VjaGVuZCcpO1xyXG5cclxuICAvKipcclxuICAgKiBSZXBlYXRpbmcgZXZlbnQgZHVyaW5nIG11bHRpdG91Y2guXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtbXVsdGl0b3VjaG1vdmV9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIG11bHRpdG91Y2htb3ZlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ211bHRpdG91Y2htb3ZlJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0IG9mIG11bHRpdG91Y2guXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtbXVsdGl0b3VjaHN0YXJ0fVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBtdWx0aXRvdWNoc3RhcnQ6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignbXVsdGl0b3VjaHN0YXJ0Jyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIE1hcCBvcHRpb25zIGNoYW5nZWQuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvTWFwLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1vcHRpb25zY2hhbmdlfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBvcHRpb25zY2hhbmdlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMuTWFwPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ29wdGlvbnNjaGFuZ2UnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIHNpemUgY2hhbmdlZC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LXNpemVjaGFuZ2V9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHNpemVjaGFuZ2U6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignc2l6ZWNoYW5nZScpO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgbWFwIHR5cGUgY2hhbmdlZC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LXR5cGVjaGFuZ2V9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHR5cGVjaGFuZ2U6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcigndHlwZWNoYW5nZScpO1xyXG5cclxuICAvKipcclxuICAgKiBNb3VzZSB3aGVlbCBzY3JvbGxpbmcuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtd2hlZWx9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHlhd2hlZWw6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5NYXA+PiA9IHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCd3aGVlbCcpO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgbmdab25lOiBOZ1pvbmUsXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IHlhQXBpTG9hZGVyU2VydmljZTogWWFBcGlMb2FkZXJTZXJ2aWNlLFxyXG4gICkge31cclxuXHJcbiAgLyoqXHJcbiAgICogSGFuZGxlcyBpbnB1dCBjaGFuZ2VzIGFuZCBwYXNzZXMgdGhlbSBpbiBBUEkuXHJcbiAgICogQHBhcmFtIGNoYW5nZXNcclxuICAgKi9cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBjb25zdCBtYXAgPSB0aGlzLm1hcCQudmFsdWU7XHJcblxyXG4gICAgaWYgKG1hcCkge1xyXG4gICAgICBjb25zdCB7IGNlbnRlciwgem9vbSwgc3RhdGUsIG9wdGlvbnMgfSA9IGNoYW5nZXM7XHJcblxyXG4gICAgICBpZiAoc3RhdGUpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHRoaXMuY29tYmluZVN0YXRlKCksIG1hcCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChjZW50ZXIpIHtcclxuICAgICAgICBtYXAuc2V0Q2VudGVyKGNlbnRlci5jdXJyZW50VmFsdWUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoem9vbSkge1xyXG4gICAgICAgIG1hcC5zZXRab29tKHpvb20uY3VycmVudFZhbHVlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICBtYXAub3B0aW9ucy5zZXQob3B0aW9ucy5jdXJyZW50VmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnlhQXBpTG9hZGVyU2VydmljZVxyXG4gICAgICAubG9hZCgpXHJcbiAgICAgIC5waXBlKHRha2UoMSksIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSlcclxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgaWQgPSBnZW5lcmF0ZVJhbmRvbUlkKCk7XHJcbiAgICAgICAgY29uc3QgbWFwID0gdGhpcy5jcmVhdGVNYXAoaWQpO1xyXG5cclxuICAgICAgICB0aGlzLm1hcCQubmV4dChtYXApO1xyXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyLnNldFRhcmdldChtYXApO1xyXG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLnJlYWR5LmVtaXQoeyB5bWFwcywgdGFyZ2V0OiBtYXAgfSkpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZGVzdHJveSgpO1xyXG4gICAgdGhpcy5kZXN0cm95JC5uZXh0KCk7XHJcbiAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXN0cnVjdHMgc3RhdGUgYW5kIHBhc3NlcyBpdCBpbiBBUEkuXHJcbiAgICogQHBhcmFtIHN0YXRlXHJcbiAgICogQHBhcmFtIG1hcFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2V0U3RhdGUoc3RhdGU6IHltYXBzLklNYXBTdGF0ZSwgbWFwOiB5bWFwcy5NYXApOiB2b2lkIHtcclxuICAgIGNvbnN0IHsgYmVoYXZpb3JzLCBib3VuZHMsIGNlbnRlciwgY29udHJvbHMsIG1hcmdpbiwgdHlwZSwgem9vbSB9ID0gc3RhdGU7XHJcblxyXG4gICAgaWYgKGJlaGF2aW9ycykge1xyXG4gICAgICBtYXAuYmVoYXZpb3JzLmVuYWJsZShiZWhhdmlvcnMpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChib3VuZHMpIHtcclxuICAgICAgbWFwLnNldEJvdW5kcyhib3VuZHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjZW50ZXIpIHtcclxuICAgICAgbWFwLnNldENlbnRlcihjZW50ZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjb250cm9scykge1xyXG4gICAgICBjb250cm9scy5mb3JFYWNoKChjb250cm9sKSA9PiBtYXAuY29udHJvbHMuYWRkKGNvbnRyb2wpKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobWFyZ2luKSB7XHJcbiAgICAgIG1hcC5tYXJnaW4uc2V0RGVmYXVsdE1hcmdpbihtYXJnaW4pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlKSB7XHJcbiAgICAgIG1hcC5zZXRUeXBlKHR5cGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh6b29tKSB7XHJcbiAgICAgIG1hcC5zZXRab29tKHpvb20pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyBhIG1hcC5cclxuICAgKiBAcGFyYW0gaWQgSUQgd2hpY2ggd2lsbCBiZSBzZXQgdG8gdGhlIG1hcCBjb250YWluZXIuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjcmVhdGVNYXAoaWQ6IHN0cmluZyk6IHltYXBzLk1hcCB7XHJcbiAgICBjb25zdCBjb250YWluZXJFbGVtOiBIVE1MRWxlbWVudCA9IHRoaXMuY29udGFpbmVyLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICBjb250YWluZXJFbGVtLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XHJcbiAgICBjb250YWluZXJFbGVtLnN0eWxlLmNzc1RleHQgPSAnd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsnO1xyXG5cclxuICAgIHJldHVybiBuZXcgeW1hcHMuTWFwKGlkLCB0aGlzLmNvbWJpbmVTdGF0ZSgpLCB0aGlzLm9wdGlvbnMgfHwge30pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ29tYmluZXMgdGhlIGNlbnRlciBhbmQgem9vbSBpbnRvIHNpbmdsZSBvYmplY3QuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjb21iaW5lU3RhdGUoKTogeW1hcHMuSU1hcFN0YXRlIHtcclxuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSB8fCB7fTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi5zdGF0ZSxcclxuICAgICAgY2VudGVyOiB0aGlzLmNlbnRlciB8fCBzdGF0ZS5jZW50ZXIgfHwgWzAsIDBdLFxyXG4gICAgICB6b29tOiB0aGlzLnpvb20gPz8gc3RhdGUuem9vbSA/PyAxMCxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcbiJdfQ==