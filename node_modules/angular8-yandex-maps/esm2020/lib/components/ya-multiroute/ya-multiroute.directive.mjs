import { Directive, EventEmitter, Input, Output, } from '@angular/core';
import { Subject, takeUntil } from 'rxjs';
import { filter, take } from 'rxjs/operators';
import { EventManager } from '../../event-manager/event-manager';
import * as i0 from "@angular/core";
import * as i1 from "../ya-map/ya-map.component";
/**
 * The `ya-multiroute` component wraps `ymaps.multiRouter.MultiRoute` class from the Yandex.Maps API.
 * You can configure it via the component's inputs.
 * Events can be bound using the outputs of the component.
 *
 * @example
 * ```html
 * <ya-map [center]="[55.761952, 37.620739]">
 *   <ya-multiroute
 *     [referencePoints]="[[55.751952, 37.600739], 'Красные ворота, Москва']"
 *     [models]="{ params: { routingMode: 'pedestrian' } }"
 *   ></ya-multiroute>
 * </ya-map>
 * ```
 */
export class YaMultirouteDirective {
    constructor(ngZone, yaMapComponent) {
        this.ngZone = ngZone;
        this.yaMapComponent = yaMapComponent;
        this.destroy$ = new Subject();
        this.eventManager = new EventManager(this.ngZone);
        /**
         * Multi-route instance is added to a Map.
         */
        this.ready = new EventEmitter();
        /**
         * Change to the active route.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/multiRouter.MultiRoute.html#event_detail__event-activeroutechange}
         */
        this.activeroutechange = this.eventManager.getLazyEmitter('activeroutechange');
        /**
         * Closing the balloon.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/multiRouter.MultiRoute.html#event_detail__event-balloonclose}
         */
        this.balloonclose = this.eventManager.getLazyEmitter('balloonclose');
        /**
         * Opening the balloon.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/multiRouter.MultiRoute.html#event_detail__event-balloonopen}
         */
        this.balloonopen = this.eventManager.getLazyEmitter('balloonopen');
        /**
         * The event occurs at the time of setting the map center and its zoom level for optimal display of the multi-route.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/multiRouter.MultiRoute.html#event_detail__event-boundsautoapply}
         */
        this.boundsautoapply = this.eventManager.getLazyEmitter('boundsautoapply');
        /**
         * Changing coordinates of the geographical area covering the multi-route.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/multiRouter.MultiRoute.html#event_detail__event-boundschange}
         */
        this.boundschange = this.eventManager.getLazyEmitter('boundschange');
        /**
         * Single left-click on the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-click}
         */
        this.yaclick = this.eventManager.getLazyEmitter('click');
        /**
         * Calls the element's context menu.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-contextmenu}
         */
        this.yacontextmenu = this.eventManager.getLazyEmitter('contextmenu');
        /**
         * Double left-click on the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-dblclick}
         */
        this.yadblclick = this.eventManager.getLazyEmitter('dblclick');
        /**
         * Change to the geo object geometry.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IGeoObject.html#event_detail__event-geometrychange}
         */
        this.geometrychange = this.eventManager.getLazyEmitter('geometrychange');
        /**
         * Map reference changed.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IParentOnMap.html#event_detail__event-mapchange}
         */
        this.mapchange = this.eventManager.getLazyEmitter('mapchange');
        /**
         * Pressing the mouse button over the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mousedown}
         */
        this.yamousedown = this.eventManager.getLazyEmitter('mousedown');
        /**
         * Pointing the cursor at the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mouseenter}
         */
        this.yamouseenter = this.eventManager.getLazyEmitter('mouseenter');
        /**
         * Moving the cursor off of the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mouseleave}
         */
        this.yamouseleave = this.eventManager.getLazyEmitter('mouseleave');
        /**
         * Moving the cursor over the object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mousemove}
         */
        this.yamousemove = this.eventManager.getLazyEmitter('mousemove');
        /**
         * Letting go of the mouse button over an object.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-mouseup}
         */
        this.yamouseup = this.eventManager.getLazyEmitter('mouseup');
        /**
         * End of multitouch.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-multitouchend}
         */
        this.multitouchend = this.eventManager.getLazyEmitter('multitouchend');
        /**
         * Repeating event during multitouch.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-multitouchmove}
         */
        this.multitouchmove = this.eventManager.getLazyEmitter('multitouchmove');
        /**
         * Start of multitouch.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-multitouchstart}
         */
        this.multitouchstart = this.eventManager.getLazyEmitter('multitouchstart');
        /**
         * Change to the object options.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/ICustomizable.html#event_detail__event-optionschange}
         */
        this.optionschange = this.eventManager.getLazyEmitter('optionschange');
        /**
         * Change to the geo object overlay.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IGeoObject.html#event_detail__event-overlaychange}
         */
        this.overlaychange = this.eventManager.getLazyEmitter('overlaychange');
        /**
         * The parent object reference changed.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IChild.html#event_detail__event-parentchange}
         */
        this.parentchange = this.eventManager.getLazyEmitter('parentchange');
        /**
         * Changing pixel coordinates of the area covering the multi-route.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/multiRouter.MultiRoute.html#event_detail__event-pixelboundschange}
         */
        this.pixelboundschange = this.eventManager.getLazyEmitter('pixelboundschange');
        /**
         * Change to the geo object data.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IGeoObject.html#event_detail__event-propertieschange}
         */
        this.propertieschange = this.eventManager.getLazyEmitter('propertieschange');
        /**
         * Updating the multi-route.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/multiRouter.MultiRoute.html#event_detail__event-update}
         */
        this.update = this.eventManager.getLazyEmitter('update');
        /**
         * Mouse wheel scrolling.
         * {@link https://yandex.com/dev/maps/jsapi/doc/2.1/ref/reference/IDomEventEmitter.html#event_detail__event-wheel}
         */
        this.yawheel = this.eventManager.getLazyEmitter('wheel');
    }
    /**
     * Handles input changes and passes them in API.
     * @param changes
     */
    ngOnChanges(changes) {
        const { multiroute } = this;
        if (multiroute) {
            const { referencePoints, model, options } = changes;
            if (model) {
                this.setModel(model.currentValue, multiroute);
            }
            if (referencePoints) {
                multiroute.model.setReferencePoints(referencePoints.currentValue);
            }
            if (options) {
                multiroute.options.set(options.currentValue);
            }
        }
    }
    ngOnInit() {
        this.yaMapComponent.map$
            .pipe(filter(Boolean), take(1), takeUntil(this.destroy$))
            .subscribe((map) => {
            const multiroute = this.createMultiroute();
            this.multiroute = multiroute;
            map.geoObjects.add(multiroute);
            this.eventManager.setTarget(multiroute);
            this.ngZone.run(() => this.ready.emit({ ymaps, target: multiroute }));
        });
    }
    ngOnDestroy() {
        if (this.multiroute) {
            this.yaMapComponent?.map$.value?.geoObjects.remove(this.multiroute);
            this.eventManager.destroy();
        }
        this.destroy$.next();
        this.destroy$.complete();
    }
    /**
     * Destructs state and passes them in API.
     * @param model
     * @param multiroute
     */
    setModel(model, multiroute) {
        const { referencePoints, params } = model;
        if (referencePoints) {
            multiroute.model.setReferencePoints(referencePoints);
        }
        if (params) {
            multiroute.model.setParams(params);
        }
    }
    /**
     * Creates Multiroute.
     */
    createMultiroute() {
        return new ymaps.multiRouter.MultiRoute(this.combineModel(), this.options);
    }
    /**
     * Combines the models and reference points into single object
     */
    combineModel() {
        const model = (this.model || {});
        return {
            ...model,
            referencePoints: this.referencePoints || model.referencePoints,
        };
    }
}
YaMultirouteDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.5", ngImport: i0, type: YaMultirouteDirective, deps: [{ token: i0.NgZone }, { token: i1.YaMapComponent }], target: i0.ɵɵFactoryTarget.Directive });
YaMultirouteDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "14.2.5", type: YaMultirouteDirective, selector: "ya-multiroute", inputs: { referencePoints: "referencePoints", model: "model", options: "options" }, outputs: { ready: "ready", activeroutechange: "activeroutechange", balloonclose: "balloonclose", balloonopen: "balloonopen", boundsautoapply: "boundsautoapply", boundschange: "boundschange", yaclick: "yaclick", yacontextmenu: "yacontextmenu", yadblclick: "yadblclick", geometrychange: "geometrychange", mapchange: "mapchange", yamousedown: "yamousedown", yamouseenter: "yamouseenter", yamouseleave: "yamouseleave", yamousemove: "yamousemove", yamouseup: "yamouseup", multitouchend: "multitouchend", multitouchmove: "multitouchmove", multitouchstart: "multitouchstart", optionschange: "optionschange", overlaychange: "overlaychange", parentchange: "parentchange", pixelboundschange: "pixelboundschange", propertieschange: "propertieschange", update: "update", yawheel: "yawheel" }, usesOnChanges: true, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.5", ngImport: i0, type: YaMultirouteDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: 'ya-multiroute',
                }]
        }], ctorParameters: function () { return [{ type: i0.NgZone }, { type: i1.YaMapComponent }]; }, propDecorators: { referencePoints: [{
                type: Input
            }], model: [{
                type: Input
            }], options: [{
                type: Input
            }], ready: [{
                type: Output
            }], activeroutechange: [{
                type: Output
            }], balloonclose: [{
                type: Output
            }], balloonopen: [{
                type: Output
            }], boundsautoapply: [{
                type: Output
            }], boundschange: [{
                type: Output
            }], yaclick: [{
                type: Output
            }], yacontextmenu: [{
                type: Output
            }], yadblclick: [{
                type: Output
            }], geometrychange: [{
                type: Output
            }], mapchange: [{
                type: Output
            }], yamousedown: [{
                type: Output
            }], yamouseenter: [{
                type: Output
            }], yamouseleave: [{
                type: Output
            }], yamousemove: [{
                type: Output
            }], yamouseup: [{
                type: Output
            }], multitouchend: [{
                type: Output
            }], multitouchmove: [{
                type: Output
            }], multitouchstart: [{
                type: Output
            }], optionschange: [{
                type: Output
            }], overlaychange: [{
                type: Output
            }], parentchange: [{
                type: Output
            }], pixelboundschange: [{
                type: Output
            }], propertieschange: [{
                type: Output
            }], update: [{
                type: Output
            }], yawheel: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieWEtbXVsdGlyb3V0ZS5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9hbmd1bGFyOC15YW5kZXgtbWFwcy9zcmMvbGliL2NvbXBvbmVudHMveWEtbXVsdGlyb3V0ZS95YS1tdWx0aXJvdXRlLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUNULFlBQVksRUFDWixLQUFLLEVBS0wsTUFBTSxHQUVQLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBYyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RELE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFOUMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLG1DQUFtQyxDQUFDOzs7QUFVakU7Ozs7Ozs7Ozs7Ozs7O0dBY0c7QUFJSCxNQUFNLE9BQU8scUJBQXFCO0lBa05oQyxZQUE2QixNQUFjLEVBQW1CLGNBQThCO1FBQS9ELFdBQU0sR0FBTixNQUFNLENBQVE7UUFBbUIsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBak4zRSxhQUFRLEdBQUcsSUFBSSxPQUFPLEVBQVEsQ0FBQztRQUUvQixpQkFBWSxHQUFHLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQXlCOUQ7O1dBRUc7UUFDTyxVQUFLLEdBQTZELElBQUksWUFBWSxFQUV6RixDQUFDO1FBRUo7OztXQUdHO1FBQ08sc0JBQWlCLEdBQ3pCLElBQUksQ0FBQyxZQUFZLENBQUMsY0FBYyxDQUFDLG1CQUFtQixDQUFDLENBQUM7UUFFeEQ7OztXQUdHO1FBQ08saUJBQVksR0FDcEIsSUFBSSxDQUFDLFlBQVksQ0FBQyxjQUFjLENBQUMsY0FBYyxDQUFDLENBQUM7UUFFbkQ7OztXQUdHO1FBQ08sZ0JBQVcsR0FDbkIsSUFBSSxDQUFDLFlBQVks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c0JBQXZCLEtBQUs7Z0JBTUcsS0FBSztzQkFBYixLQUFLO2dCQVFHLE9BQU87c0JBQWYsS0FBSztnQkFLSSxLQUFLO3NCQUFkLE1BQU07Z0JBUUcsaUJBQWlCO3NCQUExQixNQUFNO2dCQU9HLFlBQVk7c0JBQXJCLE1BQU07Z0JBT0csV0FBVztzQkFBcEIsTUFBTTtnQkFPRyxlQUFlO3NCQUF4QixNQUFNO2dCQU9HLFlBQVk7c0JBQXJCLE1BQU07Z0JBT0csT0FBTztzQkFBaEIsTUFBTTtnQkFPRyxhQUFhO3NCQUF0QixNQUFNO2dCQU9HLFVBQVU7c0JBQW5CLE1BQU07Z0JBT0csY0FBYztzQkFBdkIsTUFBTTtnQkFPRyxTQUFTO3NCQUFsQixNQUFNO2dCQU9HLFdBQVc7c0JBQXBCLE1BQU07Z0JBT0csWUFBWTtzQkFBckIsTUFBTTtnQkFPRyxZQUFZO3NCQUFyQixNQUFNO2dCQU9HLFdBQVc7c0JBQXBCLE1BQU07Z0JBT0csU0FBUztzQkFBbEIsTUFBTTtnQkFPRyxhQUFhO3NCQUF0QixNQUFNO2dCQU9HLGNBQWM7c0JBQXZCLE1BQU07Z0JBT0csZUFBZTtzQkFBeEIsTUFBTTtnQkFPRyxhQUFhO3NCQUF0QixNQUFNO2dCQU9HLGFBQWE7c0JBQXRCLE1BQU07Z0JBT0csWUFBWTtzQkFBckIsTUFBTTtnQkFPRyxpQkFBaUI7c0JBQTFCLE1BQU07Z0JBT0csZ0JBQWdCO3NCQUF6QixNQUFNO2dCQU9HLE1BQU07c0JBQWYsTUFBTTtnQkFPRyxPQUFPO3NCQUFoQixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBEaXJlY3RpdmUsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIElucHV0LFxyXG4gIE5nWm9uZSxcclxuICBPbkNoYW5nZXMsXHJcbiAgT25EZXN0cm95LFxyXG4gIE9uSW5pdCxcclxuICBPdXRwdXQsXHJcbiAgU2ltcGxlQ2hhbmdlcyxcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCwgdGFrZVVudGlsIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IGZpbHRlciwgdGFrZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbmltcG9ydCB7IEV2ZW50TWFuYWdlciB9IGZyb20gJy4uLy4uL2V2ZW50LW1hbmFnZXIvZXZlbnQtbWFuYWdlcic7XHJcbmltcG9ydCB7IFlhRXZlbnQgfSBmcm9tICcuLi8uLi9tb2RlbHMveWEtZXZlbnQnO1xyXG5pbXBvcnQgeyBZYVJlYWR5RXZlbnQgfSBmcm9tICcuLi8uLi9tb2RlbHMveWEtcmVhZHktZXZlbnQnO1xyXG5pbXBvcnQgeyBZYU1hcENvbXBvbmVudCB9IGZyb20gJy4uL3lhLW1hcC95YS1tYXAuY29tcG9uZW50JztcclxuXHJcbi8qKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbnR5cGUgT3B0aW9uYWw8VCwgSyBleHRlbmRzIGtleW9mIFQ+ID0gUGljazxQYXJ0aWFsPFQ+LCBLPiAmIE9taXQ8VCwgSz47XHJcblxyXG4vKipcclxuICogVGhlIGB5YS1tdWx0aXJvdXRlYCBjb21wb25lbnQgd3JhcHMgYHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGVgIGNsYXNzIGZyb20gdGhlIFlhbmRleC5NYXBzIEFQSS5cclxuICogWW91IGNhbiBjb25maWd1cmUgaXQgdmlhIHRoZSBjb21wb25lbnQncyBpbnB1dHMuXHJcbiAqIEV2ZW50cyBjYW4gYmUgYm91bmQgdXNpbmcgdGhlIG91dHB1dHMgb2YgdGhlIGNvbXBvbmVudC5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgaHRtbFxyXG4gKiA8eWEtbWFwIFtjZW50ZXJdPVwiWzU1Ljc2MTk1MiwgMzcuNjIwNzM5XVwiPlxyXG4gKiAgIDx5YS1tdWx0aXJvdXRlXHJcbiAqICAgICBbcmVmZXJlbmNlUG9pbnRzXT1cIltbNTUuNzUxOTUyLCAzNy42MDA3MzldLCAn0JrRgNCw0YHQvdGL0LUg0LLQvtGA0L7RgtCwLCDQnNC+0YHQutCy0LAnXVwiXHJcbiAqICAgICBbbW9kZWxzXT1cInsgcGFyYW1zOiB7IHJvdXRpbmdNb2RlOiAncGVkZXN0cmlhbicgfSB9XCJcclxuICogICA+PC95YS1tdWx0aXJvdXRlPlxyXG4gKiA8L3lhLW1hcD5cclxuICogYGBgXHJcbiAqL1xyXG5ARGlyZWN0aXZlKHtcclxuICBzZWxlY3RvcjogJ3lhLW11bHRpcm91dGUnLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgWWFNdWx0aXJvdXRlRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBkZXN0cm95JCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XHJcblxyXG4gIHByaXZhdGUgcmVhZG9ubHkgZXZlbnRNYW5hZ2VyID0gbmV3IEV2ZW50TWFuYWdlcih0aGlzLm5nWm9uZSk7XHJcblxyXG4gIHByaXZhdGUgbXVsdGlyb3V0ZT86IHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGU7XHJcblxyXG4gIC8qKlxyXG4gICAqIE11bHRpLXJvdXRlIHJlZmVyZW5jZSBwb2ludHMuXHJcbiAgICogU2hvcnRoYW5kIGZvciBgW21vZGVsc109XCJ7IHJlZmVyZW5jZVBvaW50czogWzAsIDBdIH1cImAuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSU11bHRpUm91dGVSZWZlcmVuY2VQb2ludC5odG1sfVxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIHJlZmVyZW5jZVBvaW50czogeW1hcHMuSU11bHRpUm91dGVSZWZlcmVuY2VQb2ludFtdO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgZGF0YSBtb2RlbCBvZiBhIG11bHRpLXJvdXRlLCBvciB0aGUgbW9kZWwgZGVzY3JpcHRpb24gb2JqZWN0LlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL211bHRpUm91dGVyLk11bHRpUm91dGUuaHRtbCNtdWx0aVJvdXRlci5NdWx0aVJvdXRlX19wYXJhbS1tb2RlbH1cclxuICAgKi9cclxuICBASW5wdXQoKSBtb2RlbDpcclxuICAgIHwgeW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZU1vZGVsXHJcbiAgICB8IE9wdGlvbmFsPHltYXBzLklNdWx0aVJvdXRlTW9kZWxKc29uLCAncmVmZXJlbmNlUG9pbnRzJz47XHJcblxyXG4gIC8qKlxyXG4gICAqIE11bHRpLXJvdXRlIG9wdGlvbnMuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvbXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZS5odG1sI211bHRpUm91dGVyLk11bHRpUm91dGVfX3BhcmFtLW9wdGlvbnN9XHJcbiAgICovXHJcbiAgQElucHV0KCkgb3B0aW9uczogeW1hcHMubXVsdGlSb3V0ZXIuSU11bHRpUm91dGVPcHRpb25zO1xyXG5cclxuICAvKipcclxuICAgKiBNdWx0aS1yb3V0ZSBpbnN0YW5jZSBpcyBhZGRlZCB0byBhIE1hcC5cclxuICAgKi9cclxuICBAT3V0cHV0KCkgcmVhZHk6IEV2ZW50RW1pdHRlcjxZYVJlYWR5RXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID0gbmV3IEV2ZW50RW1pdHRlcjxcclxuICAgIFlhUmVhZHlFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPlxyXG4gID4oKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2hhbmdlIHRvIHRoZSBhY3RpdmUgcm91dGUuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvbXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZS5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtYWN0aXZlcm91dGVjaGFuZ2V9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIGFjdGl2ZXJvdXRlY2hhbmdlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdhY3RpdmVyb3V0ZWNoYW5nZScpO1xyXG5cclxuICAvKipcclxuICAgKiBDbG9zaW5nIHRoZSBiYWxsb29uLlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL211bHRpUm91dGVyLk11bHRpUm91dGUuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LWJhbGxvb25jbG9zZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgYmFsbG9vbmNsb3NlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdiYWxsb29uY2xvc2UnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogT3BlbmluZyB0aGUgYmFsbG9vbi5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9tdWx0aVJvdXRlci5NdWx0aVJvdXRlLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1iYWxsb29ub3Blbn1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgYmFsbG9vbm9wZW46IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2JhbGxvb25vcGVuJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoZSBldmVudCBvY2N1cnMgYXQgdGhlIHRpbWUgb2Ygc2V0dGluZyB0aGUgbWFwIGNlbnRlciBhbmQgaXRzIHpvb20gbGV2ZWwgZm9yIG9wdGltYWwgZGlzcGxheSBvZiB0aGUgbXVsdGktcm91dGUuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvbXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZS5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtYm91bmRzYXV0b2FwcGx5fVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBib3VuZHNhdXRvYXBwbHk6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2JvdW5kc2F1dG9hcHBseScpO1xyXG5cclxuICAvKipcclxuICAgKiBDaGFuZ2luZyBjb29yZGluYXRlcyBvZiB0aGUgZ2VvZ3JhcGhpY2FsIGFyZWEgY292ZXJpbmcgdGhlIG11bHRpLXJvdXRlLlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL211bHRpUm91dGVyLk11bHRpUm91dGUuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LWJvdW5kc2NoYW5nZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgYm91bmRzY2hhbmdlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdib3VuZHNjaGFuZ2UnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogU2luZ2xlIGxlZnQtY2xpY2sgb24gdGhlIG9iamVjdC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JRG9tRXZlbnRFbWl0dGVyLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1jbGlja31cclxuICAgKi9cclxuICBAT3V0cHV0KCkgeWFjbGljazogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGU+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignY2xpY2snKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbHMgdGhlIGVsZW1lbnQncyBjb250ZXh0IG1lbnUuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtY29udGV4dG1lbnV9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHlhY29udGV4dG1lbnU6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2NvbnRleHRtZW51Jyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIERvdWJsZSBsZWZ0LWNsaWNrIG9uIHRoZSBvYmplY3QuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtZGJsY2xpY2t9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHlhZGJsY2xpY2s6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2RibGNsaWNrJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIENoYW5nZSB0byB0aGUgZ2VvIG9iamVjdCBnZW9tZXRyeS5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JR2VvT2JqZWN0Lmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1nZW9tZXRyeWNoYW5nZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgZ2VvbWV0cnljaGFuZ2U6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ2dlb21ldHJ5Y2hhbmdlJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIE1hcCByZWZlcmVuY2UgY2hhbmdlZC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JUGFyZW50T25NYXAuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LW1hcGNoYW5nZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgbWFwY2hhbmdlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdtYXBjaGFuZ2UnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogUHJlc3NpbmcgdGhlIG1vdXNlIGJ1dHRvbiBvdmVyIHRoZSBvYmplY3QuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtbW91c2Vkb3dufVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSB5YW1vdXNlZG93bjogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGU+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignbW91c2Vkb3duJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFBvaW50aW5nIHRoZSBjdXJzb3IgYXQgdGhlIG9iamVjdC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JRG9tRXZlbnRFbWl0dGVyLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1tb3VzZWVudGVyfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSB5YW1vdXNlZW50ZXI6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ21vdXNlZW50ZXInKTtcclxuXHJcbiAgLyoqXHJcbiAgICogTW92aW5nIHRoZSBjdXJzb3Igb2ZmIG9mIHRoZSBvYmplY3QuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtbW91c2VsZWF2ZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgeWFtb3VzZWxlYXZlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdtb3VzZWxlYXZlJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIE1vdmluZyB0aGUgY3Vyc29yIG92ZXIgdGhlIG9iamVjdC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JRG9tRXZlbnRFbWl0dGVyLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1tb3VzZW1vdmV9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHlhbW91c2Vtb3ZlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdtb3VzZW1vdmUnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogTGV0dGluZyBnbyBvZiB0aGUgbW91c2UgYnV0dG9uIG92ZXIgYW4gb2JqZWN0LlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL0lEb21FdmVudEVtaXR0ZXIuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LW1vdXNldXB9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHlhbW91c2V1cDogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGU+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignbW91c2V1cCcpO1xyXG5cclxuICAvKipcclxuICAgKiBFbmQgb2YgbXVsdGl0b3VjaC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JRG9tRXZlbnRFbWl0dGVyLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1tdWx0aXRvdWNoZW5kfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBtdWx0aXRvdWNoZW5kOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdtdWx0aXRvdWNoZW5kJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlcGVhdGluZyBldmVudCBkdXJpbmcgbXVsdGl0b3VjaC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JRG9tRXZlbnRFbWl0dGVyLmh0bWwjZXZlbnRfZGV0YWlsX19ldmVudC1tdWx0aXRvdWNobW92ZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgbXVsdGl0b3VjaG1vdmU6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ211bHRpdG91Y2htb3ZlJyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0IG9mIG11bHRpdG91Y2guXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtbXVsdGl0b3VjaHN0YXJ0fVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBtdWx0aXRvdWNoc3RhcnQ6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ211bHRpdG91Y2hzdGFydCcpO1xyXG5cclxuICAvKipcclxuICAgKiBDaGFuZ2UgdG8gdGhlIG9iamVjdCBvcHRpb25zLlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL0lDdXN0b21pemFibGUuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LW9wdGlvbnNjaGFuZ2V9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIG9wdGlvbnNjaGFuZ2U6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ29wdGlvbnNjaGFuZ2UnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2hhbmdlIHRvIHRoZSBnZW8gb2JqZWN0IG92ZXJsYXkuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSUdlb09iamVjdC5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtb3ZlcmxheWNoYW5nZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgb3ZlcmxheWNoYW5nZTogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGU+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcignb3ZlcmxheWNoYW5nZScpO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgcGFyZW50IG9iamVjdCByZWZlcmVuY2UgY2hhbmdlZC5cclxuICAgKiB7QGxpbmsgaHR0cHM6Ly95YW5kZXguY29tL2Rldi9tYXBzL2pzYXBpL2RvYy8yLjEvcmVmL3JlZmVyZW5jZS9JQ2hpbGQuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LXBhcmVudGNoYW5nZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgcGFyZW50Y2hhbmdlOiBPYnNlcnZhYmxlPFlhRXZlbnQ8eW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZT4+ID1cclxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmdldExhenlFbWl0dGVyKCdwYXJlbnRjaGFuZ2UnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2hhbmdpbmcgcGl4ZWwgY29vcmRpbmF0ZXMgb2YgdGhlIGFyZWEgY292ZXJpbmcgdGhlIG11bHRpLXJvdXRlLlxyXG4gICAqIHtAbGluayBodHRwczovL3lhbmRleC5jb20vZGV2L21hcHMvanNhcGkvZG9jLzIuMS9yZWYvcmVmZXJlbmNlL211bHRpUm91dGVyLk11bHRpUm91dGUuaHRtbCNldmVudF9kZXRhaWxfX2V2ZW50LXBpeGVsYm91bmRzY2hhbmdlfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBwaXhlbGJvdW5kc2NoYW5nZTogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGU+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcigncGl4ZWxib3VuZHNjaGFuZ2UnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2hhbmdlIHRvIHRoZSBnZW8gb2JqZWN0IGRhdGEuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSUdlb09iamVjdC5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtcHJvcGVydGllc2NoYW5nZX1cclxuICAgKi9cclxuICBAT3V0cHV0KCkgcHJvcGVydGllc2NoYW5nZTogT2JzZXJ2YWJsZTxZYUV2ZW50PHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGU+PiA9XHJcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5nZXRMYXp5RW1pdHRlcigncHJvcGVydGllc2NoYW5nZScpO1xyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGluZyB0aGUgbXVsdGktcm91dGUuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvbXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZS5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtdXBkYXRlfVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSB1cGRhdGU6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ3VwZGF0ZScpO1xyXG5cclxuICAvKipcclxuICAgKiBNb3VzZSB3aGVlbCBzY3JvbGxpbmcuXHJcbiAgICoge0BsaW5rIGh0dHBzOi8veWFuZGV4LmNvbS9kZXYvbWFwcy9qc2FwaS9kb2MvMi4xL3JlZi9yZWZlcmVuY2UvSURvbUV2ZW50RW1pdHRlci5odG1sI2V2ZW50X2RldGFpbF9fZXZlbnQtd2hlZWx9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIHlhd2hlZWw6IE9ic2VydmFibGU8WWFFdmVudDx5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlPj4gPVxyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZ2V0TGF6eUVtaXR0ZXIoJ3doZWVsJyk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgbmdab25lOiBOZ1pvbmUsIHByaXZhdGUgcmVhZG9ubHkgeWFNYXBDb21wb25lbnQ6IFlhTWFwQ29tcG9uZW50KSB7fVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGVzIGlucHV0IGNoYW5nZXMgYW5kIHBhc3NlcyB0aGVtIGluIEFQSS5cclxuICAgKiBAcGFyYW0gY2hhbmdlc1xyXG4gICAqL1xyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgIGNvbnN0IHsgbXVsdGlyb3V0ZSB9ID0gdGhpcztcclxuXHJcbiAgICBpZiAobXVsdGlyb3V0ZSkge1xyXG4gICAgICBjb25zdCB7IHJlZmVyZW5jZVBvaW50cywgbW9kZWwsIG9wdGlvbnMgfSA9IGNoYW5nZXM7XHJcblxyXG4gICAgICBpZiAobW9kZWwpIHtcclxuICAgICAgICB0aGlzLnNldE1vZGVsKG1vZGVsLmN1cnJlbnRWYWx1ZSwgbXVsdGlyb3V0ZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChyZWZlcmVuY2VQb2ludHMpIHtcclxuICAgICAgICBtdWx0aXJvdXRlLm1vZGVsLnNldFJlZmVyZW5jZVBvaW50cyhyZWZlcmVuY2VQb2ludHMuY3VycmVudFZhbHVlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICBtdWx0aXJvdXRlLm9wdGlvbnMuc2V0KG9wdGlvbnMuY3VycmVudFZhbHVlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLnlhTWFwQ29tcG9uZW50Lm1hcCRcclxuICAgICAgLnBpcGUoZmlsdGVyKEJvb2xlYW4pLCB0YWtlKDEpLCB0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpXHJcbiAgICAgIC5zdWJzY3JpYmUoKG1hcCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG11bHRpcm91dGUgPSB0aGlzLmNyZWF0ZU11bHRpcm91dGUoKTtcclxuICAgICAgICB0aGlzLm11bHRpcm91dGUgPSBtdWx0aXJvdXRlO1xyXG5cclxuICAgICAgICBtYXAuZ2VvT2JqZWN0cy5hZGQobXVsdGlyb3V0ZSk7XHJcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIuc2V0VGFyZ2V0KG11bHRpcm91dGUpO1xyXG4gICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB0aGlzLnJlYWR5LmVtaXQoeyB5bWFwcywgdGFyZ2V0OiBtdWx0aXJvdXRlIH0pKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLm11bHRpcm91dGUpIHtcclxuICAgICAgdGhpcy55YU1hcENvbXBvbmVudD8ubWFwJC52YWx1ZT8uZ2VvT2JqZWN0cy5yZW1vdmUodGhpcy5tdWx0aXJvdXRlKTtcclxuICAgICAgdGhpcy5ldmVudE1hbmFnZXIuZGVzdHJveSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZGVzdHJveSQubmV4dCgpO1xyXG4gICAgdGhpcy5kZXN0cm95JC5jb21wbGV0ZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVzdHJ1Y3RzIHN0YXRlIGFuZCBwYXNzZXMgdGhlbSBpbiBBUEkuXHJcbiAgICogQHBhcmFtIG1vZGVsXHJcbiAgICogQHBhcmFtIG11bHRpcm91dGVcclxuICAgKi9cclxuICBwcml2YXRlIHNldE1vZGVsKFxyXG4gICAgbW9kZWw6IHltYXBzLklNdWx0aVJvdXRlTW9kZWxKc29uLFxyXG4gICAgbXVsdGlyb3V0ZTogeW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZSxcclxuICApOiB2b2lkIHtcclxuICAgIGNvbnN0IHsgcmVmZXJlbmNlUG9pbnRzLCBwYXJhbXMgfSA9IG1vZGVsO1xyXG5cclxuICAgIGlmIChyZWZlcmVuY2VQb2ludHMpIHtcclxuICAgICAgbXVsdGlyb3V0ZS5tb2RlbC5zZXRSZWZlcmVuY2VQb2ludHMocmVmZXJlbmNlUG9pbnRzKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocGFyYW1zKSB7XHJcbiAgICAgIG11bHRpcm91dGUubW9kZWwuc2V0UGFyYW1zKHBhcmFtcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDcmVhdGVzIE11bHRpcm91dGUuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjcmVhdGVNdWx0aXJvdXRlKCk6IHltYXBzLm11bHRpUm91dGVyLk11bHRpUm91dGUge1xyXG4gICAgcmV0dXJuIG5ldyB5bWFwcy5tdWx0aVJvdXRlci5NdWx0aVJvdXRlKHRoaXMuY29tYmluZU1vZGVsKCksIHRoaXMub3B0aW9ucyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb21iaW5lcyB0aGUgbW9kZWxzIGFuZCByZWZlcmVuY2UgcG9pbnRzIGludG8gc2luZ2xlIG9iamVjdFxyXG4gICAqL1xyXG4gIHByaXZhdGUgY29tYmluZU1vZGVsKCk6IHltYXBzLklNdWx0aVJvdXRlTW9kZWxKc29uIHtcclxuICAgIGNvbnN0IG1vZGVsID0gKHRoaXMubW9kZWwgfHwge30pIGFzIHltYXBzLklNdWx0aVJvdXRlTW9kZWxKc29uO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIC4uLm1vZGVsLFxyXG4gICAgICByZWZlcmVuY2VQb2ludHM6IHRoaXMucmVmZXJlbmNlUG9pbnRzIHx8IG1vZGVsLnJlZmVyZW5jZVBvaW50cyxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcbiJdfQ==